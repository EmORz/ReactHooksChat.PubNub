{"version":3,"sources":["useInput.js","App.js","index.js"],"names":["useInput","_useState","useState","_useState2","Object","slicedToArray","value","setValue","onChange","event","target","Log","props","react_default","a","createElement","index_es","component","messages","map","item","index","Message","key","uuid","text","App","defaultChannel","params","window","location","search","substring","split","i","length","pair","decodeURI","channel","setChannel","_useState3","_useState4","setMessages","_useState5","Date","getTime","join","username","tempChannel","tempMessage","handleKeyDown","id","publishMessage","newChannel","trim","newURL","origin","history","pushState","messageObject","PubNub","publishKey","subscribeKey","publish","message","goBack","query","useEffect","console","log","pubnub","addListener","status","statusEvent","category","msg","newMessages","push","concat","subscribe","channels","count","stringifiedTimeToken","response","entry","unsubscribeAll","addEventListener","removeEventListener","className","variant","inline","style","width","onKeyDown","placeholder","fullWidth","inputProps","aria-label","autoFocus","size","color","onClick","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.6ef51876.chunk.js","sourcesContent":["import { useState } from 'react';\n\nfunction useInput()\n{\n  let [value, setValue] = useState('');\n  let onChange = function(event){\n    setValue(event.target.value);\n  };\n  return {\n    value,\n    setValue,\n    onChange\n  };\n}\n\nexport default useInput;\n","//These are the two hooks we use the most of through this Chat\nimport React, { useState, useEffect} from 'react';\n\n//has a few css stylings that we need.\nimport './App.css';\n\n//This is a hook I created to reduce some of the bloat we get with watching inputs for changes.\nimport useInput from './useInput.js';\n\n//Lets us import PubNub for our chat infrastructure capabailites.\nimport PubNub from 'pubnub';\n\n//Material UI Components\nimport {Card, CardActions, CardContent,List, ListItem,Button,Typography,Input} from '@material-ui/core';\n\n// Our main Component, the parent to all the others, the one to rule them all.\nfunction App(){\n  //Set a default channel incase someone navigates to the base url without\n  //specificfying a channel name parameter.\n  let defaultChannel = \"Global\";\n  //Access the parameters provided in the URL\n  let query = window.location.search.substring(1);\n  let params = query.split(\"&\");\n  for(let i = 0; i < params.length;i++){\n    var pair = params[i].split(\"=\");\n    //If the user input a channel then the default channel is now set\n    //If not, we still navigate to the default channel.\n    if(pair[0] === \"channel\" && pair[1] !== \"\"){\n      defaultChannel = decodeURI(pair[1]);\n    }\n  }\n\n  //Set the states using useState hook,\n  //We have our messages, a message adding buffer, our channel,the username, and\n  //temp channel and message using the useInput hook. We access what the\n  //user is currently typing with those hooks.\n  const [channel,setChannel] = useState(defaultChannel);\n  const [messages,setMessages] = useState([]);\n  const [username,] = useState(['user', new Date().getTime()].join('-'));\n  const tempChannel = useInput();\n  const tempMessage = useInput();\n  //This is where we set up PubNub and handle events that come through. Reruns on channel name update!\n  useEffect(()=>{\n    console.log(\"setting up pubnub\");\n    const pubnub = new PubNub({\n      publishKey: \"pub-c-d62180cb-302f-4c84-b05d-6975d2e5634a\",\n      subscribeKey: \"sub-c-081cd550-75d2-11e9-a9da-06324c5f6dce\",\n      uuid: username\n    });\n\n\n    pubnub.addListener({\n     status: function(statusEvent) {\n       if (statusEvent.category === \"PNConnectedCategory\") {\n         console.log(\"Connected to PubNub!\")\n       }\n     },\n     message: function(msg) {\n       if(msg.message.text){\n         console.log(msg.message.text)\n         let newMessages = [];\n         newMessages.push({\n           uuid:msg.message.uuid,\n           text: msg.message.text\n         });\n         setMessages(messages=>messages.concat(newMessages))\n       }\n     }\n   });\n     //Subscribes to the channel in our state\n     pubnub.subscribe({\n         channels: [channel]\n     });\n     pubnub.history(\n     {\n         channel: channel,\n         count: 10, // 100 is the default\n         stringifiedTimeToken: true // false is the default\n     }, function (status, response){\n        let newMessages = [];\n         for (let i  = 0; i < response.messages.length;i++){\n           newMessages.push({\n             uuid:response.messages[i].entry.uuid ,\n             text: response.messages[i].entry.text\n           });\n         }\n         setMessages(messages=>messages.concat(newMessages));\n       }\n     );\n    return function cleanup(){\n      console.log(\"shutting down pubnub\");\n      pubnub.unsubscribeAll();\n      setMessages([]);\n    }\n  },[channel, username]);\n  //Adding back browser button listener\n  useEffect(() => {\n    window.addEventListener(\"popstate\",goBack);\n\n    return function cleanup(){\n      window.removeEventListener(\"popstate\",goBack);\n    }\n  },[]);\n\n  function handleKeyDown(event){\n    if(event.target.id === \"messageInput\"){\n      if (event.key === 'Enter') {\n        publishMessage();\n      }\n    }else if(event.target.id === \"channelInput\"){\n      if (event.key === 'Enter') {\n        //Navigates to new channels\n        const newChannel = tempChannel.value.trim();\n        if(newChannel){\n          if(channel !== newChannel){\n            //If the user isnt trying to navigate to the same channel theyre on\n            setChannel(newChannel);\n            let newURL = window.location.origin + \"/ReactHooksChat.PubNub/?channel=\" + newChannel;\n            window.history.pushState(null, '',newURL);\n            tempChannel.setValue('');\n          }\n        }else{\n          //If the user didnt put anything into the channel Input\n          if(channel !== \"Global\"){\n            //If the user isnt trying to navigate to the same channel theyre on\n            setChannel(\"Global\");\n            let newURL = window.location.origin + \"/ReactHooksChat.PubNub/\";\n            window.history.pushState(null, '',newURL);\n            tempChannel.setValue('');\n          }\n        }\n      }\n    }\n\n  }\n\n  //Publishing messages via PubNub\n  function publishMessage(){\n   if (tempMessage.value) {\n     let messageObject = {\n       text: tempMessage.value,\n       uuid: username\n     };\n\n     const pubnub = new PubNub({\n       publishKey: \"pub-c-d62180cb-302f-4c84-b05d-6975d2e5634a\",\n       subscribeKey: \"sub-c-081cd550-75d2-11e9-a9da-06324c5f6dce\",\n       uuid: username\n     });\n     pubnub.publish({\n       message: messageObject,\n       channel: channel\n     });\n     tempMessage.setValue('');\n   }\n }\n  function goBack() {\n    //Access the parameters provided in the URL\n    let query = window.location.search.substring(1);\n    if(!query){\n      setChannel(\"Global\")\n    }else{\n      let params = query.split(\"&\");\n      for(let i = 0; i < params.length;i++){\n        var pair = params[i].split(\"=\");\n        //If the user input a channel then the default channel is now set\n        //If not, we still navigate to the default channel.\n        if(pair[0] === \"channel\" && pair[1] !== \"\"){\n            setChannel(decodeURI(pair[1]))\n        }\n      }\n    }\n  }\n\n  //This returns how our page will look, including a couple\n  // components into the heirarchy to help organize our page. We can also pass information down\n  //to our children through props.\n    return(\n      <Card >\n          <CardContent>\n            <div className=\"top\">\n              <Typography variant=\"h4\" inline >\n                PubNub React Chat\n                </Typography>\n              <Input\n                style={{width:'100px'}}\n                className=\"channel\"\n                id=\"channelInput\"\n                onKeyDown={handleKeyDown}\n                placeholder ={channel}\n                onChange = {tempChannel.onChange}\n                value={tempChannel.value}\n              />\n            </div>\n            <div >\n              <Log messages={messages}/>\n            </div>\n          </CardContent>\n          <CardActions>\n            <Input\n              placeholder=\"Enter a message\"\n              fullWidth={true}\n              id=\"messageInput\"\n              value={tempMessage.value}\n              onChange={tempMessage.onChange}\n              onKeyDown={handleKeyDown}\n              inputProps={{'aria-label': 'Message Field',}}\n              autoFocus={true}\n            />\n            <Button\n              size=\"small\"\n              color=\"primary\"\n              onClick={publishMessage}\n              >\n              Submit\n            </Button>\n          </CardActions>\n        </Card>\n      );\n}\n\n//Log functional component that is the list of messages\nfunction Log(props) {\n\n  return(\n    <List component=\"nav\">\n      <ListItem>\n      <Typography component=\"div\">\n        { props.messages.map((item, index)=>(\n          <Message key={index} uuid={item.uuid} text={item.text}/>\n        )) }\n      </Typography>\n      </ListItem>\n    </List>\n  )\n};\n\n//Our message functional component that formats each message.\nfunction Message(props){\n  return (\n    <div >\n      { props.uuid }: { props.text }\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}