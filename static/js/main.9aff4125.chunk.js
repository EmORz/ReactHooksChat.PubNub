(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{166:function(e,t,n){e.exports=n(268)},171:function(e,t,n){},172:function(e,t,n){},268:function(e,t,n){"use strict";n.r(t);var a=n(0),u=n.n(a),o=n(22),c=n.n(o),l=n(16),i=(n(171),n(19));n(172);var s=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],u=t[1];return{value:n,setValue:u,onChange:function(e){u(e.target.value)}}},r=n(41),d=n.n(r),b=n(10);function m(e){return u.a.createElement(b.f,{component:"nav",className:"log",id:"list"},u.a.createElement(b.g,null,u.a.createElement(b.h,{component:"div"},e.messages.map(function(e,t){return u.a.createElement(f,{key:t,uuid:e.uuid,text:e.text})}))))}function f(e){return u.a.createElement("div",{style:{flexWrap:"wrap"}},e.uuid,": ",e.text)}var p=function(){for(var e="Global",t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var o=t[n].split("=");"channel"===o[0]&&""!==o[1]&&(e=decodeURI(o[1]))}var c=Object(a.useState)(e),l=Object(i.a)(c,2),r=l[0],f=l[1],p=Object(a.useState)([]),g=Object(i.a)(p,2),h=g[0],v=g[1],w=Object(a.useState)(["user",(new Date).getTime()].join("-")),E=Object(i.a)(w,1)[0],y=s(),x=s();function j(e){if("messageInput"===e.target.id)"Enter"===e.key&&C();else if("channelInput"===e.target.id&&"Enter"===e.key){var t=y.value.trim();if(t){if(r!==t){f(t);var n=window.location.origin+"/ReactHooksChat.PubNub/?channel="+t;window.history.pushState(null,"",n),y.setValue("")}}else if("Global"!==r){f("Global");var a=window.location.origin+"/ReactHooksChat.PubNub/";window.history.pushState(null,"",a),y.setValue("")}}}function C(){if(x.value){var e={text:x.value,uuid:E};new d.a({publishKey:"pub-c-d62180cb-302f-4c84-b05d-6975d2e5634a",subscribeKey:"sub-c-081cd550-75d2-11e9-a9da-06324c5f6dce",uuid:E}).publish({message:e,channel:r}),x.setValue("")}}function O(){var e=document.getElementById("list");e.scrollTop=e.scrollHeight}function k(){var e=window.location.search.substring(1);if(e)for(var t=e.split("&"),n=0;n<t.length;n++){var a=t[n].split("=");"channel"===a[0]&&""!==a[1]&&f(decodeURI(a[1]))}else f("Global")}return Object(a.useEffect)(function(){console.log("setting up pubnub");var e=new d.a({publishKey:"pub-c-d62180cb-302f-4c84-b05d-6975d2e5634a",subscribeKey:"sub-c-081cd550-75d2-11e9-a9da-06324c5f6dce",uuid:E});return e.addListener({status:function(e){"PNConnectedCategory"===e.category&&console.log("Connected to PubNub!")},message:function(e){if(e.message.text){console.log(e.message.text);var t=[];t.push({uuid:e.message.uuid,text:e.message.text}),v(function(e){return e.concat(t)}),O()}}}),e.subscribe({channels:[r]}),e.history({channel:r,count:10,stringifiedTimeToken:!0},function(e,t){for(var n=[],a=0;a<t.messages.length;a++)n.push({uuid:t.messages[a].entry.uuid,text:t.messages[a].entry.text});v(function(e){return e.concat(n)}),O()}),function(){console.log("shutting down pubnub"),e.unsubscribeAll(),v([])}},[r,E]),Object(a.useEffect)(function(){return window.addEventListener("popstate",k),function(){window.removeEventListener("popstate",k)}},[]),u.a.createElement(b.b,null,u.a.createElement(b.d,null,u.a.createElement("div",{className:"top"},u.a.createElement(b.h,{variant:"h4",inline:!0},"PubNub React Chat"),u.a.createElement(b.e,{style:{width:"100px"},className:"channel",id:"channelInput",onKeyDown:j,placeholder:r,onChange:y.onChange,value:y.value})),u.a.createElement("div",null,u.a.createElement(m,{messages:h}))),u.a.createElement(b.c,null,u.a.createElement(b.e,{placeholder:"Enter a message",fullWidth:!0,id:"messageInput",value:x.value,onChange:x.onChange,onKeyDown:j,inputProps:{"aria-label":"Message Field"},autoFocus:!0}),u.a.createElement(b.a,{size:"small",color:"primary",onClick:C},"Submit")))},g=Object(l.createMuiTheme)({palette:{primary:{main:"#d02129",dark:"#d02129",light:"#d02129"}},overrides:{MuiInput:{underline:{"&:before":{borderBottom:"1px solid ".concat("#d02129")}}}}});c.a.render(u.a.createElement(l.MuiThemeProvider,{theme:g},u.a.createElement(p,null)),document.getElementById("root"))}},[[166,1,2]]]);
//# sourceMappingURL=main.9aff4125.chunk.js.map