(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{162:function(e,t,n){e.exports=n(263)},167:function(e,t,n){},168:function(e,t,n){},263:function(e,t,n){"use strict";n.r(t);var a=n(0),u=n.n(a),l=n(22),o=n.n(l),i=(n(167),n(19));n(168);var s=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],u=t[1];return{value:n,setValue:u,onChange:function(e){u(e.target.value)}}},c=n(38),r=n.n(c),d=n(10);function m(e){return u.a.createElement(d.f,{component:"nav"},u.a.createElement(d.g,null,u.a.createElement(d.h,{component:"div"},e.messages.map(function(e,t){return u.a.createElement(E,{key:t,uuid:e.uuid,text:e.text})}))))}function E(e){return u.a.createElement("div",null,e.uuid,": ",e.text)}var g=function(){for(var e="Global",t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var l=t[n].split("=");"channel"===l[0]&&""!==l[1]&&(e=decodeURI(l[1]))}var o=Object(a.useState)(e),c=Object(i.a)(o,2),E=c[0],g=c[1],b=Object(a.useState)([]),f=Object(i.a)(b,2),h=f[0],p=f[1],v=Object(a.useState)(["user",(new Date).getTime()].join("-")),w=Object(i.a)(v,1)[0],y=s(),x=s();function j(e){if("messageInput"===e.target.id)"Enter"===e.key&&R();else if("channelInput"===e.target.id&&"Enter"===e.key){var t=y.value.trim();if(t){if(E!==t){g(t);var n=window.location.origin+"?channel="+t;window.history.pushState(null,"",n),y.setValue("")}}else if("Global"!==E){g("Global");var a=window.location.origin;window.history.pushState(null,"",a),y.setValue("")}}}function R(){if(x.value){var e={text:x.value,uuid:w};new r.a({publishKey:"<ENTER-PUB-KEY-HERE>",subscribeKey:"<ENTER-SUB-KEY-HERE>",uuid:w}).publish({message:e,channel:E}),x.setValue("")}}function C(){var e=window.location.search.substring(1);if(e)for(var t=e.split("&"),n=0;n<t.length;n++){var a=t[n].split("=");"channel"===a[0]&&""!==a[1]&&g(decodeURI(a[1]))}else g("Global")}return Object(a.useEffect)(function(){console.log("setting up pubnub");var e=new r.a({publishKey:"<ENTER-PUB-KEY-HERE>",subscribeKey:"<ENTER-SUB-KEY-HERE>",uuid:w});return e.addListener({status:function(e){"PNConnectedCategory"===e.category&&console.log("Connected to PubNub!")},message:function(e){if(e.message.text){console.log(e.message.text);var t=[];t.push({uuid:e.message.uuid,text:e.message.text}),p(function(e){return e.concat(t)})}}}),e.subscribe({channels:[E]}),e.history({channel:E,count:10,stringifiedTimeToken:!0},function(e,t){for(var n=[],a=0;a<t.messages.length;a++)n.push({uuid:t.messages[a].entry.uuid,text:t.messages[a].entry.text});p(function(e){return e.concat(n)})}),function(){console.log("shutting down pubnub"),e.unsubscribeAll(),p([])}},[E,w]),Object(a.useEffect)(function(){return window.addEventListener("popstate",C),function(){window.removeEventListener("popstate",C)}},[]),u.a.createElement(d.b,null,u.a.createElement(d.d,null,u.a.createElement("div",{className:"top"},u.a.createElement(d.h,{variant:"h4",inline:!0},"PubNub React Chat"),u.a.createElement(d.e,{style:{width:"100px"},className:"channel",id:"channelInput",onKeyDown:j,placeholder:E,onChange:y.onChange,value:y.value})),u.a.createElement("div",null,u.a.createElement(m,{messages:h}))),u.a.createElement(d.c,null,u.a.createElement(d.e,{placeholder:"Enter a message",fullWidth:!0,id:"messageInput",value:x.value,onChange:x.onChange,onKeyDown:j,inputProps:{"aria-label":"Message Field"},autoFocus:!0}),u.a.createElement(d.a,{size:"small",color:"primary",onClick:R},"Submit")))};o.a.render(u.a.createElement(g,null),document.getElementById("root"))}},[[162,1,2]]]);
//# sourceMappingURL=main.b8513a58.chunk.js.map